import sys
import re # for later
def process(a,b,y):
    # entry a+b to dir/y/fn, with formatting
    # dir and fn are global variables
    if '*' in y:
        format0 = '**'
        format1 = '**'
        y1 = y.replace('*','')
    else:
        format0 = ''
        format1 = ''
        y1 = y
    if y1 not in targets.keys():
        try:
            targets[y1] = open(dir+'/'+y1+'/'+fn+'.md', 'w')
        except:
            print ('not found: '+dir+'/'+y1+'/')
            targets[y1] = None
    if targets[y1]:
        targets[y1].write(format0+a+format1+b+'\n\n')

dir = '_includes'
data = yaml.safe_load(sys.stdin)

targets = {} # Dict entries will be <file>:<content>.

for x in data:
    if x['link']:
        a = x['dates']+': ['+x['name']+']('+x['link']+'), '+x['loc']
    else:
        a = x['dates']+': '+x['name']+', '+x['loc']
    b = ('. '+x['more'] if x['more'] else '')+'.'

while line := f0.readline()[:-1]:
    x = line.split("|")
    if len(x) != 6:
        print(line)
    else:
        if x[2]:
            a = x[0]+": ["+x[1]+"]("+x[2]+"), "+x[3]
        else:
            a = x[0]+": "+x[1]+", "+x[3]
        b = (". "+x[4] if x[4] else "")+"."
        for y in x[-1].split(","):
            process(a,b,y)
